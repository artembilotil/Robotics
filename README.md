# üéÆ TETRIS Arduino - SOLID Architecture

–ü–æ–≤–Ω–∏–π –ø–µ—Ä–µ–ø–∏—Å–∞–Ω–∏–π –ø—Ä–æ–µ–∫—Ç Tetris –¥–ª—è Arduino –∑ –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è–º **SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤**.

## üöÄ –®–≤–∏–¥–∫–∏–π —Å—Ç–∞—Ä—Ç

```cpp
// –£ setup():
gameEngine->init();

// –£ loop():
gameEngine->update();
if (gameEngine->getGameOverStatus()) {
    gameEngine->waitForRestart();
}
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
src/
‚îú‚îÄ‚îÄ main.cpp                    # –¢–æ—á–∫–∞ –≤—Ö–æ–¥—É Arduino
‚îÇ
‚îî‚îÄ‚îÄ core/                       # SOLID –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏
    ‚îú‚îÄ‚îÄ Block.h                 # –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–¥–∞—é—á–æ–≥–æ –±–ª–æ–∫–∞
    ‚îú‚îÄ‚îÄ GameField.h             # –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–æ–ª–µ–º
    ‚îú‚îÄ‚îÄ BlockController.h       # –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä—É—Ö–æ–º –±–ª–æ–∫–∞
    ‚îú‚îÄ‚îÄ BlockFactory.h          # –ì–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—ñ–≤
    ‚îú‚îÄ‚îÄ GameRenderer.h          # –ú–∞–ª—é–≤–∞–Ω–Ω—è –Ω–∞ –¥–∏—Å–ø–ª–µ–π
    ‚îú‚îÄ‚îÄ GameTimer.h             # –ß–∞—Å–æ–≤—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏
    ‚îú‚îÄ‚îÄ InputHandler.h          # –î–∂–æ–π—Å—Ç–∏–∫ —ñ –∫–Ω–æ–ø–∫–∏
    ‚îú‚îÄ‚îÄ ShapeData.h             # –§—ñ–≥—É—Ä–∏ + —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    ‚îî‚îÄ‚îÄ GameEngine.h            # –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞ (FACADE)

DOCUMENTATION.md               # –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ –π –æ–ø–∏—Å–∞–Ω–Ω—è –∫–ª–∞—Å—ñ–≤
SOLID_EXPLANATION.md          # –î–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤
```

---

## üéØ –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏

### 1. **GameEngine** - –°–µ—Ä–¥—Ü–µ –≥—Ä–∏
```cpp
GameEngine engine(width, height, modules, display, joystick, button);
engine.init();      // –ü–æ—á–∞—Ç–∏—Å—è –Ω–æ–≤—É –≥—Ä—É
engine.update();    // –û–Ω–æ–≤–∏—Ç–∏ –∫–∞–¥—Ä
engine.getScore();  // –û—Ç—Ä–∏–º–∞—Ç–∏ –æ—á–∫–∏
```

### 2. **GameField** - –ü–æ–ª–µ –≥—Ä–∏
- –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø—ñ–∫—Å–µ–ª—è–º–∏ (8-–±—ñ—Ç–Ω—ñ —Ä—è–¥–∫–∏)
- –ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∫–æ–ª—ñ–∑—ñ–π
- –û—á–∏—â–µ–Ω–Ω—è –ø–æ–≤–Ω–∏—Ö —Ä—è–¥–∫—ñ–≤

### 3. **BlockController** - –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–ª–æ–∫–æ–º
- –†—É—Ö –≤–ª—ñ–≤–æ/–≤–ø—Ä–∞–≤–æ
- –ü–æ–≤–æ—Ä–æ—Ç –∑ –ø–µ—Ä–µ–≤—ñ—Ä–∫–æ—é –∫–æ–ª—ñ–∑—ñ–π
- –ü–∞–¥—ñ–Ω–Ω—è

### 4. **GameRenderer** - –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
- –ú–∞–ª—é–≤–∞–Ω–Ω—è –Ω–∞ MAX7219
- Game over –∞–Ω—ñ–º–∞—Ü—ñ—è
- –õ–æ–∫–∞–ª—å–Ω–∏–π –±—É—Ñ–µ—Ä –¥–ª—è –º–æ–¥—É–ª—ñ–≤

### 5. **InputHandler** - –í—Ö–æ–¥–∏
- **JoystickInput** - —á–∏—Ç–∞–Ω–Ω—è –¥–∂–æ–π—Å—Ç–∏–∫–∞ (X, Y)
- **ButtonInput** - —á–∏—Ç–∞–Ω–Ω—è –∫–Ω–æ–ø–∫–∏ –∑ –¥—Ä–µ–±–µ–∑–≥–æ–º

### 6. **GameTimer** - –ß–∞—Å–æ–≤—ñ —ñ–Ω—Ç–µ—Ä–≤–∞–ª–∏
```cpp
GameTimer moveTimer{200};
if (moveTimer.isReady()) { /* —Ä—É—Ö–Ω—É—Ç–∏ –±–ª–æ–∫ */ }
```

### 7. **ShapeData** - –§—ñ–≥—É—Ä–∏
- 7 —Ç–∏–ø—ñ–≤ —Ñ—ñ–≥—É—Ä (I, O, T, L, J, S, Z)
- **IShapeProvider** - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö
- **ShapeProvider** - –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∞ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—è

### 8. **BlockFactory** - –ì–µ–Ω–µ—Ä—É–≤–∞–Ω–Ω—è –±–ª–æ–∫—ñ–≤
```cpp
Block newBlock = factory.createRandomBlock();
```

---

## üèóÔ∏è SOLID –ø—Ä–∏–Ω—Ü–∏–ø–∏ –≤ –ø—Ä–æ–µ–∫—Ç—ñ

| –ü—Ä–∏–Ω—Ü–∏–ø | –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è |
|---------|-----------|
| **S** (Single) | –ö–æ–∂–µ–Ω –∫–ª–∞—Å –º–∞—î –æ–¥–Ω—É —Ä–æ–ª—å (Field, Renderer, Timer...) |
| **O** (Open/Closed) | –õ–µ–≥–∫–æ –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—ñ –¥–∏—Å–ø–ª–µ—ó/–≤—Ö–æ–¥–∏/—Ñ—ñ–≥—É—Ä–∏ |
| **L** (Liskov) | –ú–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω—é–≤–∞—Ç–∏ —Ä–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ |
| **I** (Interface) | –ú—ñ–Ω—ñ–º–∞–ª—å–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º—ñ–∂ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏ |
| **D** (Dependency) | –ó–∞–ª–µ–∂–∏–º–æ –≤—ñ–¥ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ–≤ (IShapeProvider) |

---

## üìù –ü–æ—è—Å–Ω–µ–Ω–Ω—è –∫–ª–∞—Å—ñ–≤

### Block.h
```cpp
class Block {
    const int (*shape)[2];  // –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–∏ 4 –ø—ñ–∫—Å–µ–ª—ñ–≤
    int x, y;               // –ü–æ–∑–∏—Ü—ñ—è
    int rotation;           // –í–µ—Ä—Å—ñ—è –ø–æ–≤–æ—Ä–æ—Ç—É (0-3)
    char type;              // –¢–∏–ø ('I', 'O', 'T'...)
};
```

### GameField.h
```cpp
class GameField {
    uint8_t *field;  // –ú–∞—Å–∏–≤ –±–∞–π—Ç—ñ–≤ [32]
                     // –ö–æ–∂–µ–Ω –±–∞–π—Ç = 8 –ø—ñ–∫—Å–µ–ª—ñ–≤ —É —Ä—è–¥–∫—É
    
    bool getPixel(x, y);              // –û—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–∫—Å–µ–ª—å
    void setPixel(x, y);              // –í—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ –ø—ñ–∫—Å–µ–ª—å
    bool checkCollision(...);          // –ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑—ñ—Ç–∫–Ω–µ–Ω–Ω—è
    int clearFullRows();               // –û—á–∏—Å—Ç–∏—Ç–∏ —Ä—è–¥–∫–∏
};
```

### BlockController.h
```cpp
class BlockController {
    void moveLeft();                   // –†—É—Ö –≤–ª—ñ–≤–æ
    void moveRight();                  // –†—É—Ö –≤–ø—Ä–∞–≤–æ
    void rotate();                     // –ü–æ–≤–æ—Ä–æ—Ç (–∑ wall-kick)
    bool dropOneStep();                // –ü–∞–¥—ñ–Ω–Ω—è (–ø–æ–≤–µ—Ä—Ç–∞—î —á–∏ –ø—Ä–æ–¥–æ–≤–∂—É—î—Ç—å—Å—è)
};
```

### GameRenderer.h
```cpp
class GameRenderer {
    void render(const GameField&, const Block&);  // –ú–∞–ª—é–≤–∞—Ç–∏ –∫–∞–¥—Ä
    void playGameOverAnimation();                  // –ú–∏–≥–∞–Ω–Ω—è
};
```

### InputHandler.h
```cpp
class JoystickInput {
    int getHorizontalInput();          // -1, 0, +1
    int getDropSpeedBoost();           // 0-690 (–ø—Ä–∏—Å–∫–æ—Ä–µ–Ω–Ω—è)
};

class ButtonInput {
    bool wasPressed();                 // –û–¥–Ω–æ—Ä–∞–∑–æ–≤–∏–π –Ω–∞—Ç–∏—Å–∫
    void waitForPress();               // –ë–ª–æ–∫—É—é—á–∏–π –æ—á—ñ–∫—É–≤–∞–Ω–Ω—è
};
```

### GameTimer.h
```cpp
class GameTimer {
    bool isReady();                    // –ü—Ä–æ–π—à–æ–≤ —á–∞—Å?
    void setInterval(ms);              // –ó–º—ñ–Ω–∏—Ç–∏ —ñ–Ω—Ç–µ—Ä–≤–∞–ª
    void reset();                      // –°–∫–∏–Ω—É—Ç–∏ —Ç–∞–π–º–µ—Ä
};
```

---

## üéÆ –¶–∏–∫–ª –≥—Ä–∏

```
setup()
  ‚Üí GameEngine::init()
    ‚Üí GameField::clear()
    ‚Üí GameRenderer::initialize()
    ‚Üí BlockFactory::createRandomBlock()

loop() [1000+ —Ä–∞–∑—ñ–≤ –Ω–∞ —Å–µ–∫—É–Ω–¥—É]
  ‚Üí GameEngine::update()
    ‚îú‚îÄ JoystickInput::getHorizontalInput()
    ‚îú‚îÄ BlockController::moveLeft/Right()
    ‚îú‚îÄ ButtonInput::wasPressed()
    ‚îú‚îÄ BlockController::rotate()
    ‚îú‚îÄ JoystickInput::getDropSpeedBoost()
    ‚îú‚îÄ GameTimer::dropTimer.isReady()
    ‚îú‚îÄ BlockController::dropOneStep()
    ‚îú‚îÄ [–Ø–ö–©–û –¥–Ω–æ:]
    ‚îÇ  ‚îú‚îÄ GameField::addBlock()
    ‚îÇ  ‚îú‚îÄ GameField::clearFullRows()
    ‚îÇ  ‚îî‚îÄ BlockFactory::createRandomBlock()
    ‚îî‚îÄ GameRenderer::render()
```

---

## üîß –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (main.cpp)

```cpp
#define DIN_PIN 6        // Data IN (MAX7219)
#define CLK_PIN 5        // Clock (MAX7219)
#define CS_PIN 3         // Chip Select (MAX7219)
#define NUM_MODULES 4    // –ú–æ–¥—É–ª—ñ 8x8 LED

#define VRx_PIN A0       // –î–∂–æ–π—Å—Ç–∏–∫ X
#define VRy_PIN A1       // –î–∂–æ–π—Å—Ç–∏–∫ Y
#define SW_PIN 30        // –ö–Ω–æ–ø–∫–∞ –ø–æ–≤–æ—Ä–æ—Ç

const int SCREEN_WIDTH = 8;
const int SCREEN_HEIGHT = 32;  // 4 –º–æ–¥—É–ª—ñ √ó 8
```

---

## üí° –Ø–∫ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏

### –î–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ñ—ñ–≥—É—Ä—É
1. –í—ñ–¥–∫—Ä–∏—Ç–∏ `core/ShapeData.h`
2. –î–æ–¥–∞—Ç–∏ –º–∞—Å–∏–≤ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç
3. –û–±–Ω–æ–≤–∏—Ç–∏ `ShapeProvider::getShape()`
4. –ì–æ—Ç–æ–≤–æ! üéâ

### –ó–∞–º—ñ–Ω–∏—Ç–∏ MAX7219 –Ω–∞ OLED
1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `OLEDRenderer : public IRenderer`
2. –†–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ `render()` –¥–ª—è OLED
3. –ó–∞–º—ñ–Ω–∏—Ç–∏ —É GameEngine
4. –ë–µ–∑ —ñ–Ω—à–∏—Ö –∑–º—ñ–Ω! ‚ú®

### –î–æ–¥–∞—Ç–∏ –∑–≤—É–∫–∏
1. –°—Ç–≤–æ—Ä–∏—Ç–∏ `SoundManager` –∫–ª–∞—Å
2. –î–æ–¥–∞—Ç–∏ —É GameEngine
3. –í–∏–∫–ª–∏–∫–∞—Ç–∏ –ø—Ä–∏ –æ—á–∏—â–µ–Ω–Ω—ñ —Ä—è–¥–∫—ñ–≤
4. Done! üîä

---

## üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è

| | –°—Ç–∞—Ä–∏–π | –ù–æ–≤–∏–π |
|---|--------|-------|
| main.cpp | 379 —Ä—è–¥–∫—ñ–≤ | 30 —Ä—è–¥–∫—ñ–≤ |
| –ö–ª–∞—Å—ñ–≤ | 3 | 9 |
| –†–æ–∑—É–º—ñ–Ω–Ω—è | –°–∫–ª–∞–¥–Ω–æ | –ü—Ä–æ—Å—Ç—ñ—à–µ |
| –†–æ–∑—à–∏—Ä–µ–Ω–Ω—è | –í–∞–∂–∫–æ | –õ–µ–≥–∫–æ |
| –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è | –ù–µ–º–æ–∂–ª–∏–≤–æ | –ü—Ä–æ—Å—Ç–æ |

---

## üéì –ù–∞–≤—á–∞–Ω–Ω—è

**–§–∞–π–ª–∏ –¥–ª—è –≤–∏–≤—á–µ–Ω–Ω—è –≤ –ø–æ—Ä—è–¥–∫—É:**
1. `Block.h` - –ø—Ä–æ—Å—Ç–∏–π —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏–π –∫–ª–∞—Å
2. `GameTimer.h` - –ø—Ä–æ—Å—Ç–∏–π —É—Ç–∏–ª—ñ—Ç–∞—Ä–Ω–∏–π –∫–ª–∞—Å
3. `InputHandler.h` - —Ä–æ–±–æ—Ç–∞ –∑ –ø–æ—Ä—Ç–∞–º–∏
4. `GameField.h` - –±—ñ—Ç–æ–≤—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó
5. `BlockController.h` - –ª–æ–≥—ñ–∫–∞ —Ä—É—Ö—ñ–≤
6. `GameRenderer.h` - –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è
7. `BlockFactory.h` - –ø–∞—Ç—Ç–µ—Ä–Ω Factory
8. `ShapeData.h` - —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∏ (IShapeProvider)
9. `GameEngine.h` - –ø–∞—Ç—Ç–µ—Ä–Ω Facade, –æ–±'—î–¥–Ω–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ
10. `main.cpp` - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥—É

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—è

- **DOCUMENTATION.md** -Êû∂Êßã, –∫–ª–∞—Å–∏, –º–µ—Ç–æ–¥
- **SOLID_EXPLANATION.md** - –î–µ—Ç–∞–ª—å–Ω–µ –ø–æ—è—Å–Ω–µ–Ω–Ω—è –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤ –∑ –ø—Ä–∏–∫–ª–∞–¥–∞–º–∏

---

## üöÄ –ö–æ–º–ø—ñ–ª—è—Ü—ñ—è

```bash
platformio run --environment uno       # –°–∫–æ–º–ø—ñ–ª—é–≤–∞—Ç–∏
platformio run --target upload --environment uno  # –ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏
platformio run --target clean          # –û—á–∏—Å—Ç–∏—Ç–∏
```

---

## ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω–∏–π —Å–ø–∏—Å–æ–∫ —Ä–æ–∑—É–º—ñ–Ω–Ω—è

- [ ] –†–æ–∑—É–º—ñ—é —è–∫ `GameField` –∑–±–µ—Ä—ñ–≥–∞—î –¥–∞–Ω—ñ (–±—ñ—Ç–∏)
- [ ] –ó–Ω–∞—é —è–∫ `BlockController` –ø–µ—Ä–µ–≤—ñ—Ä—è—î –∫–æ–ª—ñ–∑—ñ—ó
- [ ] –†–æ–∑—É–º—ñ—é `GameTimer` –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó
- [ ] –ó–Ω–∞—é —è–∫ `GameRenderer` –º–∞–ª—é—î –Ω–∞ –º–æ–¥—É–ª—ñ
- [ ] –†–æ–∑—É–º—ñ—é —Ä–æ–ª—å `IShapeProvider`
- [ ] –ó–Ω–∞—é —è–∫ `GameEngine` –æ–±'—î–¥–Ω—É—î –≤—Å–µ
- [ ] –ú–æ–∂—É –¥–æ–¥–∞—Ç–∏ –Ω–æ–≤—É —Ñ—ñ–≥—É—Ä—É
- [ ] –ú–æ–∂—É –∑–∞–º—ñ–Ω–∏—Ç–∏ –¥–∏—Å–ø–ª–µ–π
- [ ] –†–æ–∑—É–º—ñ—é 5 SOLID –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤

---

## üéØ –ù–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏

1. **–†–æ–∑–±–µ—Ä—ñ—Ç—å—Å—è –∑ –∫–æ–¥–æ–º** - –ø—Ä–æ—á–∏—Ç–∞–π—Ç–µ —Ñ–∞–π–ª–∏ –≤ –ø–æ—Ä—è–¥–∫—É –≤–∏—â–µ
2. **–î–æ–¥–∞–π—Ç–µ –∑–≤—É–∫–∏** - —Å—Ç–≤–æ—Ä—ñ—Ç—å `SoundManager` –∫–ª–∞—Å
3. **–î–æ–¥–∞–π—Ç–µ –º–µ–Ω—é** - —Ä–æ–∑—à–∏—Ä—Ç–µ `GameEngine`
4. **–î–æ–¥–∞–π—Ç–µ —Ä—ñ–≤–Ω—ñ** - –∑–º—ñ–Ω—ñ—Ç—å `dropInterval` –¥–∏–Ω–∞–º—ñ—á–Ω–æ
5. **–ü–æ—Ä—Ç—É–π—Ç–µ –Ω–∞ LCD** - —Å—Ç–≤–æ—Ä—ñ—Ç—å `LCDRenderer`

---

## üìû –ü–∏—Ç–∞–Ω–Ω—è?

–î–∏–≤—ñ—Ç—å—Å—è **DOCUMENTATION.md** —ñ **SOLID_EXPLANATION.md**!

---

**–ü—Ä–æ–µ–∫—Ç: Tetris Arduino**  
**–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞: SOLID Principles**  
**–°—Ç–∞—Ç—É—Å: ‚úÖ –ì–æ—Ç–æ–≤–æ –¥–æ —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è**
